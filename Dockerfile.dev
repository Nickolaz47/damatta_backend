FROM node

WORKDIR /app

COPY package*.json /app

RUN npm install 

COPY . .

ENV PORT=${PORT}
ENV ENV=${ENV}
ENV DEV_DB_NAME=${DEV_DB_NAME}
ENV DEV_DB_USER=${DEV_DB_USER}
ENV DEV_DB_PASSWORD=${DEV_DB_PASSWORD}
ENV DEV_DB_URI=${DEV_DB_URI}
ENV DEV_FRONT_URL=${DEV_FRONT_URL}
ENV JWT_ACCESS_SECRET=${JWT_ACCESS_SECRET}
ENV JWT_REFRESH_SECRET=${JWT_REFRESH_SECRET}

RUN npm run build

EXPOSE ${PORT}

CMD ["npm", "run", "docker-dev"]